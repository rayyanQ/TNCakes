<?php include($_SERVER['DOCUMENT_ROOT']."/head/connect.php");session_start();if(isset($_POST['old_pass'])===true & isset($_POST['pass'])===true){$password=$_POST['old_pass'];$new_pass=$_POST['pass'];$email=$_SESSION['Email'];$userquery=mysqli_query($con,"SELECT password,salt FROM users WHERE email='$email' AND deleted='0'");$row=mysqli_fetch_assoc($userquery);$salt=$row["salt"];$hash=$row['password'];$password=$password.$salt;if(password_verify($password,$hash)){$char="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789#$%";$new_salt=substr(str_shuffle($char),0,15);$new_pass=$new_pass.$new_salt;$new_pass=password_hash($new_pass,PASSWORD_DEFAULT);$updatePass=mysqli_query($con,"UPDATE users SET password='$new_pass', salt='$new_salt' WHERE email='$email'");echo "Your password has been updated.";}else{echo 'The password is incorrect.';}}